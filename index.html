<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Up/Down Trading</title>
<style>
:root{
  --bg:#071426; --card:#0b1220; --accent:#06b6d4; --accent2:#7c3aed;
  --muted:#98a6b8; --win:#16a34a; --lose:#ef4444; --glass: rgba(255,255,255,0.03);
}
*{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Roboto,Arial}
body{margin:0;background:linear-gradient(180deg,#031027,#071426);color:#e8f0fb}
.wrap{max-width:980px;margin:auto;padding:16px}
header{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800}
h1{margin:0;font-size:18px}
.grid{display:grid;grid-template-columns:1fr 360px;gap:14px}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:12px;border-radius:12px}
canvas{width:100%;height:300px;border-radius:10px;display:block;background:#041026}
.info-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
.stat{background:var(--glass);padding:8px;border-radius:8px;min-width:120px}
.stat .label{font-size:12px;color:var(--muted)}
.stat .value{font-size:16px;margin-top:4px}
.controls{display:flex;flex-direction:column;gap:10px}
.balance{display:flex;justify-content:space-between;align-items:center}
.big{font-size:20px;font-weight:800}
label{font-size:13px;color:var(--muted)}
input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.btn-row{display:flex;gap:8px}
button{flex:1;padding:12px;border-radius:10px;border:0;font-weight:800;cursor:pointer}
.btn-up{background:linear-gradient(180deg,#06b6d4,#0284c7);color:#012}
.btn-down{background:linear-gradient(180deg,#f97316,#ef4444);color:#111}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:var(--muted);cursor:pointer}
.log{max-height:280px;overflow:auto;padding:8px;background:rgba(255,255,255,0.01);border-radius:8px}
.trade{display:flex;justify-content:space-between;padding:8px;border-bottom:1px dashed rgba(255,255,255,0.02)}
.trade.win{background:rgba(22,163,74,0.05)}
.trade.lose{background:rgba(239,68,68,0.05)}
.small{font-size:12px;color:var(--muted)}
@media(max-width:940px){.grid{grid-template-columns:1fr} canvas{height:240px}}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">TRADE</div>
    <h1>Up / Down Trading</h1>
  </header>
  <div class="grid">
    <!-- Chart -->
    <div class="card">
      <canvas id="chart"></canvas>
      <div class="info-row">
        <div class="stat"><div class="label">Price</div><div id="price" class="value">—</div></div>
        <div class="stat"><div class="label">Change</div><div id="change" class="value">—</div></div>
        <div class="stat"><div class="label">Open Trades</div><div id="open-positions" class="value">0</div></div>
      </div>
    </div>

    <!-- Controls -->
    <aside class="controls card">
      <div class="balance">
        <div>
          <div class="small">Balance</div>
          <div id="balance" class="big">৳0.00</div>
        </div>
        <div style="text-align:right">
          <div class="small">Payout</div>
          <div class="big">1.9x</div>
        </div>
      </div>

      <div>
        <label>Stake (৳)</label>
        <input id="stake" type="number" min="1" step="1" value="50" />
      </div>
      <div>
        <label>Duration (seconds)</label>
        <input id="duration" type="number" min="1" max="60" value="5" />
      </div>

      <div class="btn-row">
        <button id="btn-up" class="btn-up">UP ▲</button>
        <button id="btn-down" class="btn-down">DOWN ▼</button>
      </div>

      <div>
        <div class="small">Claim Bonus</div>
        <div style="display:flex;gap:8px;margin-top:6px">
          <input id="claim-code" type="text" autocomplete="off" />
          <button id="btn-claim" class="btn-ghost">Claim</button>
        </div>
        <div id="claim-msg" class="small" style="margin-top:6px"></div>
      </div>

      <div class="small" style="margin-top:10px">Recent Trades</div>
      <div id="log" class="log"></div>
    </aside>
  </div>
</div>

<script>
const LOCAL_BAL='trade_balance';
const LOCAL_LOG='trade_log';
const LOCAL_CLAIMED='trade_claimed_codes';
const PAYOUT=1.9;

let balance=Number(localStorage.getItem(LOCAL_BAL)||0);
let tradesLog=JSON.parse(localStorage.getItem(LOCAL_LOG)||'[]');
let claimedCodes=JSON.parse(localStorage.getItem(LOCAL_CLAIMED)||'[]');
let openPositions=[];

// You can add multiple codes here
const VALID_CODES = { '199234': 100, 'WELCOME50': 50, 'BONUS20': 20 };

const balanceEl=document.getElementById('balance');
const priceEl=document.getElementById('price');
const changeEl=document.getElementById('change');
const openPositionsEl=document.getElementById('open-positions');
const stakeEl=document.getElementById('stake');
const durationEl=document.getElementById('duration');
const logEl=document.getElementById('log');
const claimInput=document.getElementById('claim-code');
const claimBtn=document.getElementById('btn-claim');
const claimMsg=document.getElementById('claim-msg');

function saveState(){
  localStorage.setItem(LOCAL_BAL, balance);
  localStorage.setItem(LOCAL_LOG, JSON.stringify(tradesLog));
  localStorage.setItem(LOCAL_CLAIMED, JSON.stringify(claimedCodes));
}
function renderLogs(){
  logEl.innerHTML='';
  for(let i=tradesLog.length-1;i>=0;i--){
    const t=tradesLog[i];
    const div=document.createElement('div');
    div.className='trade '+(t.result);
    div.innerHTML=`<div>${t.side} ৳${t.stake}<div class="small">Start:৳${t.start.toFixed(2)} End:৳${t.end.toFixed(2)}</div></div>
    <div style="text-align:right">${t.result==='win'?'+৳'+t.profit.toFixed(2):'-৳'+t.stake.toFixed(2)}</div>`;
    logEl.appendChild(div);
  }
}
function updateUI(){
  balanceEl.textContent='৳'+balance.toFixed(2);
  openPositionsEl.textContent=openPositions.length;
  renderLogs();
  // Disable trade buttons if balance is 0
  const btns=[document.getElementById('btn-up'),document.getElementById('btn-down')];
  btns.forEach(b=>b.disabled=balance<=0);
}
function addTradeLog(entry){tradesLog.push(entry);saveState();updateUI();}
function placeTrade(side){
  if(balance<=0){alert('Balance is 0. Please claim first.');return;}
  const stake=Number(stakeEl.value)||1;
  if(stake>balance){alert('Not enough balance');return;}
  const dur=Math.max(1,Math.min(60,Number(durationEl.value)||5));
  balance-=stake;
  const start=price;
  const pos={id:Date.now(),side,stake,start,expires:Date.now()+dur*1000};
  openPositions.push(pos);
  saveState();updateUI();
  setTimeout(()=>{
    const end=price;
    let win=false;
    if(side==='UP'&&end>start)win=true;
    if(side==='DOWN'&&end<start)win=true;
    if(win){const payout=stake*PAYOUT;balance+=payout;addTradeLog({side,stake,start,end,result:'win',profit:payout-stake});}
    else addTradeLog({side,stake,start,end,result:'lose',profit:-stake});
    openPositions=openPositions.filter(p=>p.id!==pos.id);
    saveState();updateUI();
  },dur*1000);
}
document.getElementById('btn-up').onclick=()=>placeTrade('UP');
document.getElementById('btn-down').onclick=()=>placeTrade('DOWN');

// Claim logic with multiple single-use codes
claimBtn.onclick=()=>{
  const code=claimInput.value.trim();
  if(!code){claimMsg.textContent='Enter a code.';claimMsg.style.color='#f87171';return;}
  if(claimedCodes.includes(code)){claimMsg.textContent='Code already used.';claimMsg.style.color='#f87171';return;}
  if(VALID_CODES.hasOwnProperty(code)){
    const amount=VALID_CODES[code];
    balance+=amount;
    claimedCodes.push(code);
    saveState();updateUI();
    claimMsg.textContent=`৳${amount} added.`;claimMsg.style.color='#4ade80';claimInput.value='';
  }else{
    claimMsg.textContent='Invalid code.';claimMsg.style.color='#f87171';
  }
};

// ==== Price chart ====
const canvas=document.getElementById('chart');
const ctx=canvas.getContext('2d');let DPR=window.devicePixelRatio||1;
function resize(){canvas.width=canvas.clientWidth*DPR;canvas.height=canvas.clientHeight*DPR;ctx.setTransform(DPR,0,0,DPR,0,0);}
window.onresize=resize;resize();
let price=1000;let prices=[{x:0,y:price}];let t=0;
function step(){
  price+= (Math.random()-0.5)*5;
  if(price<1)price=1;
  prices.push({x:t++,y:price});if(prices.length>200)prices.shift();
}
function draw(){
  const W=canvas.clientWidth,H=canvas.clientHeight;
  ctx.clearRect(0,0,W,H);
  const minY=Math.min(...prices.map(p=>p.y)),maxY=Math.max(...prices.map(p=>p.y));
  ctx.beginPath();
  prices.forEach((p,i)=>{
    const x=i/(prices.length-1)*W;const y=H-(p.y-minY)/(maxY-minY)*H;
    if(i==0)ctx.moveTo(x,y);else ctx.lineTo(x,y);
  });
  ctx.strokeStyle='#06b6d4';ctx.lineWidth=2;ctx.stroke();
  priceEl.textContent='৳'+price.toFixed(2);
  if(prices.length>2){
    const change=((prices.at(-1).y-prices[0].y)/prices[0].y*100).toFixed(2);
    changeEl.textContent=(change>=0?'+':'')+change+'%';
  }
}
setInterval(()=>{step();draw();},500);

updateUI();
</script>
</body>
</html>
